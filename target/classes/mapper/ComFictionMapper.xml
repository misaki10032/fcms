<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cxy.fcms.mapper.ComFictionMapper">

    <insert id="addFiction" parameterType="map">
        insert into
        com_fiction(
            id,
            fic_name,
            <if test="ficAuthor!=null">
                    fic_author,
            </if>
            gmt_create,
            gmt_modified
        ) values (
            #{id},
            #{ficName},
            <if test="ficAuthor!=null">
                  #{ficAuthor},
            </if>
            now(),
            now()
        );
    </insert>
    <insert id="addFictionData">
        insert into com_fiction_data
            (id, fic_id, fic_data, gmt_create, gmt_modified,is_deleted)
        VALUE
            (#{id},#{ficId},#{text},now(),now(),0);
    </insert>
    <insert id="addFictionType">
        insert into com_fiction_type
            (id, fic_id, fic_type, gmt_create, gmt_modified,is_deleted)
        value
            (#{id},#{ficId},#{typeId},now(),now(),0);
    </insert>
    <select id="getFictions" resultType="ComFiction">
        SELECT f.id           AS id,
               f.fic_name     AS ficName,
               f.fic_author   AS ficAuthor,
               ct.ty_name     AS ficType,
               f.gmt_create   AS createTime,
               f.gmt_modified AS updateTime,
               f.is_deleted   AS isDeleted,
               f.fic_img      AS ficImg
        FROM com_fiction f
                 INNER JOIN
             com_fiction_type t ON f.id = t.fic_id
                 INNER JOIN
             com_type ct ON t.fic_type = ct.id;
    </select>


</mapper>
